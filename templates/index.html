
<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Fitness Companion - Fat Loss That Actually Makes Sense</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #ffffff;
      color: #1a1a1a;
      line-height: 1.6;
      font-weight: 400;
    }

    /* Hero Section */
    .hero {
      background: #ffffff;
      padding: 80px 20px;
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .hero h1 {
      font-size: 3.5rem;
      font-weight: 700;
      margin-bottom: 24px;
      color: #1a1a1a;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }

    .hero .subtitle {
      font-size: 1.4rem;
      color: #3B7A57;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .hero p {
      font-size: 1.2rem;
      max-width: 700px;
      margin: 0 auto 40px;
      color: #1a1a1a;
      font-weight: 400;
      line-height: 1.5;
    }

    .cta-buttons {
      margin-top: 30px;
      display: flex;
      gap: 16px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 18px 36px;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      transition: all 0.2s ease;
      border: 2px solid transparent;
      font-family: 'Inter', sans-serif;
      cursor: pointer;
    }

    .btn-primary {
      background-color: #3B7A57;
      color: white;
      box-shadow: 0 4px 12px rgba(59, 122, 87, 0.3);
    }

    .btn-primary:hover {
      background-color: #2d5a42;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(59, 122, 87, 0.4);
    }

    .btn-secondary {
      background-color: #ffffff;
      color: #3B7A57;
      border: 2px solid #3B7A57;
      box-shadow: 0 2px 8px rgba(59, 122, 87, 0.15);
    }

    .btn-secondary:hover {
      background-color: #3B7A57;
      color: white;
    }

    .hero-badges {
      margin-top: 40px;
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: #f8f9fa;
      border-radius: 20px;
      color: #3B7A57;
      font-weight: 500;
      font-size: 0.9rem;
    }

    /* Features Section */
    .features {
      background: #ffffff;
      padding: 80px 20px;
      text-align: center;
    }

    .features h2 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: #1a1a1a;
      font-weight: 600;
    }

    .features-subtitle {
      font-size: 1.2rem;
      color: #6b7280;
      margin-bottom: 50px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 40px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .feature-card {
      background: #ffffff;
      padding: 30px;
      border-radius: 16px;
      border: 2px solid #e5e5e5;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .feature-card:hover {
      transform: translateY(-4px);
      border-color: #3B7A57;
      box-shadow: 0 8px 24px rgba(59, 122, 87, 0.15);
    }

    .feature-card .icon {
      font-size: 3rem;
      margin-bottom: 20px;
      display: block;
    }

    .feature-card h3 {
      font-size: 1.4rem;
      margin-bottom: 12px;
      color: #3B7A57;
      font-weight: 600;
    }

    .feature-card p {
      color: #6b7280;
      line-height: 1.6;
    }

    /* Daily Scores Section */
    .daily-scores {
      background: #f8f9fa;
      padding: 80px 20px;
      text-align: center;
    }

    .daily-scores h2 {
      font-size: 2.5rem;
      margin-bottom: 50px;
      color: #1a1a1a;
      font-weight: 600;
    }

    .scores-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      max-width: 900px;
      margin: 0 auto;
    }

    .score-card {
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-left: 4px solid #3B7A57;
    }

    .score-card h3 {
      font-size: 1.3rem;
      margin-bottom: 12px;
      color: #3B7A57;
      font-weight: 600;
    }

    /* How It Works Section */
    .how-it-works {
      background: #ffffff;
      padding: 80px 20px;
      text-align: center;
    }

    .how-it-works h2 {
      font-size: 2.5rem;
      margin-bottom: 50px;
      color: #1a1a1a;
      font-weight: 600;
    }

    .steps-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 40px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .step-card {
      background: #ffffff;
      padding: 30px;
      border-radius: 16px;
      border: 2px solid #e5e5e5;
      position: relative;
    }

    .step-number {
      background: #3B7A57;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.2rem;
      margin: 0 auto 20px;
    }

    .step-card h3 {
      font-size: 1.4rem;
      margin-bottom: 12px;
      color: #1a1a1a;
      font-weight: 600;
    }

    /* Problem/Solution Section */
    .problem-solution {
      background: #f8f9fa;
      padding: 80px 20px;
    }

    .problem-solution .container {
      max-width: 1000px;
      margin: 0 auto;
      text-align: center;
    }

    .problem-solution h2 {
      font-size: 2.5rem;
      margin-bottom: 50px;
      color: #1a1a1a;
      font-weight: 600;
    }

    .comparison-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 50px;
    }

    .comparison-card {
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .frustrations {
      border-left: 4px solid #e74c3c;
    }

    .solutions {
      border-left: 4px solid #3B7A57;
    }

    .comparison-card h3 {
      margin-bottom: 20px;
      font-size: 1.3rem;
      font-weight: 600;
    }

    .frustrations h3 {
      color: #e74c3c;
    }

    .solutions h3 {
      color: #3B7A57;
    }

    .comparison-list {
      list-style: none;
      text-align: left;
    }

    .comparison-list li {
      padding: 8px 0;
      font-size: 1rem;
    }

    /* Final CTA Section */
    .final-cta {
      background: #ffffff;
      padding: 80px 20px;
      text-align: center;
    }

    .final-cta h2 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: #1a1a1a;
      font-weight: 600;
    }

    .final-cta p {
      font-size: 1.2rem;
      color: #6b7280;
      margin-bottom: 40px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .cta-note {
      margin-top: 20px;
      font-size: 0.9rem;
      color: #6b7280;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      backdrop-filter: blur(8px);
    }

    .modal-content {
      background-color: #ffffff;
      margin: 2% auto;
      padding: 0;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow: hidden;
      position: relative;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }

    .modal-header {
      background: #f8f9fa;
      padding: 30px;
      text-align: center;
      border-bottom: 1px solid #e5e5e5;
    }

    .modal-header h2 {
      color: #3B7A57;
      margin: 0;
      font-size: 1.8rem;
      font-weight: 600;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #ffffff;
      border-radius: 4px;
      margin-top: 20px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: #3B7A57;
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .modal-body {
      padding: 40px;
      max-height: 60vh;
      overflow-y: auto;
    }

    .quiz-step {
      display: none;
    }

    .quiz-step.active {
      display: block;
    }

    .quiz-form label {
      display: block;
      margin: 20px 0 8px 0;
      font-weight: 600;
      color: #3B7A57;
      font-size: 1rem;
    }

    .quiz-form input, .quiz-form select, .quiz-form textarea {
      width: 100%;
      padding: 16px;
      border: 2px solid #e5e5e5;
      border-radius: 12px;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
      transition: border-color 0.2s ease;
      background: #ffffff;
    }

    .quiz-form input:focus, .quiz-form select:focus, .quiz-form textarea:focus {
      outline: none;
      border-color: #3B7A57;
      box-shadow: 0 0 0 4px rgba(59, 122, 87, 0.1);
    }

    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
      margin: 12px 0;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px;
      border: 2px solid #e5e5e5;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .checkbox-item:hover {
      border-color: #3B7A57;
      background: #f8fffe;
    }

    .checkbox-item input[type="checkbox"] {
      width: auto;
      margin: 0;
    }

    .modal-footer {
      padding: 30px;
      background: #f8f9fa;
      border-top: 1px solid #e5e5e5;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn-nav {
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .btn-back {
      background: #f5f5f5;
      color: #666;
    }

    .btn-back:hover {
      background: #e5e5e5;
    }

    .btn-next {
      background: #3B7A57;
      color: white;
    }

    .btn-next:hover {
      background: #2d5a42;
      transform: translateY(-1px);
    }

    .btn-submit {
      background: #1a1a1a;
      color: white;
    }

    .btn-submit:hover {
      background: #2a2a2a;
    }

    .close {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      color: #999;
      z-index: 10;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    .close:hover {
      color: #3B7A57;
      background: #f5f5f5;
    }

    .range-display {
      text-align: center;
      margin: 8px 0;
      font-weight: 600;
      color: #3B7A57;
    }

    @media (max-width: 768px) {
      .hero h1 { font-size: 2.5rem; }
      .hero p { font-size: 1.1rem; }
      .cta-buttons { flex-direction: column; align-items: center; }
      .features { padding: 60px 20px; }
      .features-grid { grid-template-columns: 1fr; }
      .comparison-grid { grid-template-columns: 1fr; }
      .modal-content { width: 95%; margin: 5% auto; }
      .modal-body { padding: 20px; }
      .modal-footer { padding: 20px; }
    }
  </style>
</head>
<body>
  <!-- Hero Section -->
  <section class="hero">
    <h1>Fat Loss That Actually Makes Sense</h1>
    <p>Not sure where to start with your weight loss journey? Or frustrated because progress feels slow? Get daily personalised guidance that meets you where you are — with clear, honest feedback tailored to your hormones and lifestyle.</p>

    <div class="cta-buttons">
      <button onclick="openQuiz()" class="btn btn-primary">
        🚀 Start Free Assessment
      </button>
      <button onclick="openLogin()" class="btn btn-secondary">
        👤 Log In
      </button>
    </div>

    <div class="hero-badges">
      <div class="badge">
        <span>✅</span>
        <span>No restrictive diets</span>
      </div>
      <div class="badge">
        <span>🧬</span>
        <span>Science-backed</span>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="features">
    <h2>Why Fitness Companion is Different</h2>
    <p class="features-subtitle">Unlike calorie counters or generic fitness apps, we consider your whole life - including sleep, stress, hydration, and lifestyle factors that actually impact fat loss.</p>

    <div class="features-grid">
      <div class="feature-card">
        <span class="icon">🌟</span>
        <h3>Holistic Approach</h3>
        <p>We consider sleep, stress, hydration, movement, and nutrition together. Real fat loss happens when all factors work in harmony.</p>
      </div>

      <div class="feature-card">
        <span class="icon">🔄</span>
        <h3>Sustainable Results</h3>
        <p>No quick fixes or fad diets. We focus on building habits that last, with honest feedback on what's working and what needs attention.</p>
      </div>

      <div class="feature-card">
        <span class="icon">🎯</span>
        <h3>Personalised Insights</h3>
        <p>Daily feedback tailored to your individual circumstances, including hormonal changes and life factors that affect your progress.</p>
      </div>
    </div>
  </section>

  <!-- Daily Scores Section -->
  <section class="daily-scores">
    <h2>Your Daily Smart Scores</h2>

    <div class="scores-grid">
      <div class="score-card">
        <h3>Recovery Score</h3>
        <p>How well you're sleeping, managing stress, and allowing your body to recover.</p>
      </div>

      <div class="score-card">
        <h3>Nutrition Score</h3>
        <p>Simple tracking of your eating patterns and hydration, with personalised tips.</p>
      </div>

      <div class="score-card">
        <h3>Movement Score</h3>
        <p>Track your activity levels and find the right balance for sustainable fat loss.</p>
      </div>
    </div>
  </section>

  <!-- How It Works Section -->
  <section class="how-it-works">
    <h2>How It Works</h2>

    <div class="steps-grid">
      <div class="step-card">
        <div class="step-number">1</div>
        <h3>Quick Setup</h3>
        <p>Answer a few personalisation questions to tailor your experience, including any individual considerations.</p>
      </div>

      <div class="step-card">
        <div class="step-number">2</div>
        <h3>Daily Check-ins</h3>
        <p>Log your weight, sleep, stress, food, and movement in under 2 minutes. Perfect for busy lifestyles.</p>
      </div>

      <div class="step-card">
        <div class="step-number">3</div>
        <h3>Get Honest Insights</h3>
        <p>Receive practical, personalised feedback on what's working and what needs attention in your fat loss journey.</p>
      </div>
    </div>
  </section>

  <!-- Problem/Solution Section -->
  <section class="problem-solution">
    <div class="container">
      <h2>Tired of Feeling Lost in Your Fat Loss Journey?</h2>

      <div class="comparison-grid">
        <div class="comparison-card frustrations">
          <h3>Common Frustrations:</h3>
          <ul class="comparison-list">
            <li>❌ "I ate well this week but gained weight"</li>
            <li>❌ "My hormones throw everything off track"</li>
            <li>❌ "I don't know if I'm doing enough exercise"</li>
            <li>❌ "Scale fluctuations make me want to give up"</li>
          </ul>
        </div>

        <div class="comparison-card solutions">
          <h3>With Fitness Companion:</h3>
          <ul class="comparison-list">
            <li>✅ Clear daily progress scores</li>
            <li>✅ Personalised insights and support</li>
            <li>✅ Honest feedback on what's really happening</li>
            <li>✅ Sustainable, realistic approach to fat loss</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Final CTA Section -->
  <section class="final-cta">
    <h2>Ready to Finally Understand Your Progress?</h2>
    <p>Join thousands of people who've found clarity in their fat loss journey with honest, personalised daily insights that actually work.</p>

    <div class="cta-buttons">
      <button onclick="openQuiz()" class="btn btn-primary">
        🚀 Start Your Questionnaire Now
      </button>
    </div>

    <p class="cta-note">No commitment • Cancel anytime • See results in your first week</p>
  </section>

  <!-- Questionnaire Modal -->
  <div id="quizModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeQuiz()">&times;</span>

      <div class="modal-header">
        <h2 id="stepTitle">Let's Get Started</h2>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
      </div>

      <form method="POST" action="/" class="quiz-form" id="quizForm">
        <div class="modal-body">

          <!-- Step 1: Personal Info -->
          <div class="quiz-step active" data-step="1">
            <label for="name">What's your first name?</label>
            <input type="text" name="name" id="name" placeholder="Enter your first name" required>

            <label for="email">Email address:</label>
            <input type="email" name="email" id="email" placeholder="your@email.com" required>

            <label for="password">Create a password:</label>
            <input type="password" name="password" id="password" placeholder="Minimum 6 characters" required>

            <label for="dob">Date of birth:</label>
            <input type="date" name="dob" id="dob" required>

            <label for="gender">Sex assigned at birth:</label>
            <select name="gender" id="gender" onchange="handleGenderChange()" required>
              <option value="">-- Please select --</option>
              <option value="female">Female</option>
              <option value="male">Male</option>
              <option value="other">Other / Prefer not to say</option>
            </select>

            <div id="periodQuestion" style="display: none;">
              <label for="hasPeriods">Do you have periods?</label>
              <select name="hasPeriods" id="hasPeriods" onchange="handlePeriodChange()">
                <option value="">-- Please select --</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select>
            </div>

            <div id="cycleQuestion" style="display: none;">
              <label for="menstrualCycle">Where are you in your cycle today?</label>
              <select name="menstrualCycle" id="menstrualCycle">
                <option value="">-- Please select --</option>
                <option value="just_started">Just started</option>
                <option value="middle">Middle of cycle</option>
                <option value="about_to_start">About to start</option>
                <option value="not_sure">Not sure</option>
              </select>
            </div>

            <div id="menopauseQuestion" style="display: none;">
              <label for="menopause">Are you going through menopause?</label>
              <select name="menopause" id="menopause" onchange="handleMenopauseChange()">
                <option value="">-- Please select --</option>
                <option value="yes">Yes</option>
                <option value="no">No</option>
              </select>
            </div>

            <div id="menopauseStage" style="display: none;">
              <label for="menopauseStage">Which stage?</label>
              <select name="menopauseStage" id="menopauseStageSelect">
                <option value="">-- Please select --</option>
                <option value="perimenopausal">Perimenopausal</option>
                <option value="menopausal">Menopausal</option>
                <option value="postmenopausal">Postmenopausal</option>
              </select>
            </div>
          </div>

          <!-- Step 2: Physical Stats & Fat Loss Goal -->
          <div class="quiz-step" data-step="2">
            <label for="height">Height (cm):</label>
            <input type="number" name="height" min="100" max="250" placeholder="170" required>

            <label for="weight">Current weight (kg):</label>
            <input type="number" name="weight" min="30" max="300" step="0.1" placeholder="70.0" required>

            <label for="goalWeight">Goal weight (kg) - optional:</label>
            <input type="number" name="goalWeight" min="30" max="300" step="0.1" placeholder="65.0">

            <input type="hidden" name="goal" value="fat_loss">

            <label for="motivation">What's your main motivation for fat loss?</label>
            <textarea name="motivation" placeholder="Tell us what's driving you to make this change..." rows="3" required></textarea>

            <label for="motivationLevel">Current motivation level (1-10):</label>
            <input type="range" name="motivationLevel" min="1" max="10" value="5" oninput="updateRangeDisplay('motivationLevel', this.value)">
            <div class="range-display" id="motivationLevelDisplay">5/10</div>
          </div>

          <!-- Step 3: Health & Lifestyle -->
          <div class="quiz-step" data-step="3">
            <label for="sleepHours">Average hours of sleep per night:</label>
            <input type="number" name="sleepHours" min="0" max="24" step="0.5" placeholder="7.5" required>

            <label for="stressLevel">Average stress level (1-10):</label>
            <input type="range" name="stressLevel" min="1" max="10" value="5" oninput="updateRangeDisplay('stressLevel', this.value)">
            <div class="range-display" id="stressLevelDisplay">5/10</div>

            <label for="activityLevel">Current activity level:</label>
            <select name="activityLevel" required>
              <option value="">-- Please select --</option>
              <option value="sedentary">Sedentary (desk job, little exercise)</option>
              <option value="lightly_active">Lightly active (light exercise 1-3 days/week)</option>
              <option value="moderately_active">Moderately active (moderate exercise 3-5 days/week)</option>
              <option value="very_active">Very active (hard exercise 6-7 days/week)</option>
            </select>

            <label for="exerciseDetails">Current exercise routine:</label>
            <textarea name="exerciseDetails" placeholder="e.g., 30-min walk daily, gym 3x weekly, yoga twice a week, or 'none currently'..." rows="2" required></textarea>

            <label for="mealsPerDay">How many meals/snacks do you typically eat per day?</label>
            <input type="number" name="mealsPerDay" min="1" max="10" placeholder="3" required>

            <label for="waterIntake">Daily water intake estimate:</label>
            <select name="waterIntake" required>
              <option value="">-- Please select --</option>
              <option value="less_than_1l">Less than 1 litre</option>
              <option value="1_to_2l">1-2 litres</option>
              <option value="2_to_3l">2-3 litres</option>
              <option value="more_than_3l">More than 3 litres</option>
            </select>
          </div>

          <!-- Step 4: Previous Attempts & Final Details -->
          <div class="quiz-step" data-step="4">
            <label>What have you tried before for fat loss? (Select all that apply)</label>
            <div class="checkbox-group">
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="calorie_counting" id="calorie_counting">
                <label for="calorie_counting">Calorie counting</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="low_carb" id="low_carb">
                <label for="low_carb">Low carb/keto</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="intermittent_fasting" id="intermittent_fasting">
                <label for="intermittent_fasting">Intermittent fasting</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="gym_membership" id="gym_membership">
                <label for="gym_membership">Gym membership</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="personal_trainer" id="personal_trainer">
                <label for="personal_trainer">Personal trainer</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" name="previousAttempts" value="nothing" id="nothing">
                <label for="nothing">This is my first serious attempt</label>
              </div>
            </div>

            <label for="biggestChallenge">What's your biggest challenge with fat loss?</label>
            <select name="biggestChallenge" required>
              <option value="">-- Please select --</option>
              <option value="motivation">Staying motivated</option>
              <option value="time">Finding time</option>
              <option value="cravings">Food cravings</option>
              <option value="energy">Low energy</option>
              <option value="knowledge">Not knowing what to do</option>
              <option value="consistency">Being consistent</option>
              <option value="plateaus">Weight loss plateaus</option>
            </select>

            <label for="mentalState">How would you describe your current mental state?</label>
            <select name="mentalState" required>
              <option value="">-- Please select --</option>
              <option value="very_positive">Very positive and ready</option>
              <option value="optimistic">Optimistic but cautious</option>
              <option value="neutral">Neutral</option>
              <option value="frustrated">Frustrated with past attempts</option>
              <option value="overwhelmed">Overwhelmed</option>
            </select>

            <input type="hidden" name="goal" value="fat_loss">
            <input type="hidden" name="aiConsent" value="yes">
          </div>

        </div>

        <div class="modal-footer">
          <button type="button" class="btn-nav btn-back" id="backBtn" onclick="previousStep()" style="display: none;">Back</button>
          <div style="flex: 1; text-align: center;">
            <span id="stepCounter">Step 1 of 4</span>
          </div>
          <button type="button" class="btn-nav btn-next" id="nextBtn" onclick="nextStep()">Next</button>
          <button type="submit" class="btn-nav btn-submit" id="submitBtn" style="display: none;">Complete Setup</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeLogin()">&times;</span>
      <div class="modal-header">
        <h2>Welcome Back</h2>
      </div>
      <div class="modal-body">
        <form class="quiz-form">
          <label for="loginEmail">Email address:</label>
          <input type="email" id="loginEmail" placeholder="your@email.com" required>
          <label for="loginPassword">Password:</label>
          <input type="password" id="loginPassword" placeholder="Your password" required>
          <button type="button" onclick="memberLogin()" class="btn-nav btn-submit" style="width: 100%; margin-top: 20px;">Log In</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    let currentStep = 1;
    const totalSteps = 4;

    const stepTitles = {
      1: "Personal Information",
      2: "Your Fat Loss Goals", 
      3: "Health & Lifestyle",
      4: "Previous Experience"
    };

    function openQuiz() {
      document.getElementById('quizModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
      updateProgress();
    }

    function closeQuiz() {
      document.getElementById('quizModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function openLogin() {
      document.getElementById('loginModal').style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeLogin() {
      document.getElementById('loginModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function handleGenderChange() {
      const gender = document.getElementById('gender').value;
      const periodQuestion = document.getElementById('periodQuestion');

      if (gender === 'female') {
        periodQuestion.style.display = 'block';
      } else {
        periodQuestion.style.display = 'none';
        document.getElementById('cycleQuestion').style.display = 'none';
        document.getElementById('menopauseQuestion').style.display = 'none';
        document.getElementById('menopauseStage').style.display = 'none';
      }
    }

    function handlePeriodChange() {
      const hasPeriods = document.getElementById('hasPeriods').value;
      const cycleQuestion = document.getElementById('cycleQuestion');
      const menopauseQuestion = document.getElementById('menopauseQuestion');

      if (hasPeriods === 'yes') {
        cycleQuestion.style.display = 'block';
        menopauseQuestion.style.display = 'none';
        document.getElementById('menopauseStage').style.display = 'none';
      } else if (hasPeriods === 'no') {
        cycleQuestion.style.display = 'none';
        menopauseQuestion.style.display = 'block';
      } else {
        cycleQuestion.style.display = 'none';
        menopauseQuestion.style.display = 'none';
        document.getElementById('menopauseStage').style.display = 'none';
      }
    }

    function handleMenopauseChange() {
      const menopause = document.getElementById('menopause').value;
      const menopauseStage = document.getElementById('menopauseStage');

      if (menopause === 'yes') {
        menopauseStage.style.display = 'block';
      } else {
        menopauseStage.style.display = 'none';
      }
    }

    function updateRangeDisplay(rangeName, value) {
      document.getElementById(rangeName + 'Display').textContent = value + '/10';
    }

    function nextStep() {
      if (validateCurrentStep()) {
        if (currentStep < totalSteps) {
          document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
          currentStep++;
          document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
          updateProgress();
          updateButtons();
        }
      }
    }

    function previousStep() {
      if (currentStep > 1) {
        document.querySelector(`[data-step="${currentStep}"]`).classList.remove('active');
        currentStep--;
        document.querySelector(`[data-step="${currentStep}"]`).classList.add('active');
        updateProgress();
        updateButtons();
      }
    }

    function validateCurrentStep() {
      const currentStepElement = document.querySelector(`[data-step="${currentStep}"]`);
      const requiredFields = currentStepElement.querySelectorAll('[required]');

      for (let field of requiredFields) {
        if (!field.value.trim()) {
          field.focus();
          return false;
        }
      }

      // Age validation on step 1
      if (currentStep === 1) {
        const dob = document.getElementById('dob').value;
        if (dob) {
          const birthDate = new Date(dob);
          const today = new Date();
          const age = today.getFullYear() - birthDate.getFullYear() - 
                     ((today.getMonth() < birthDate.getMonth()) || 
                      (today.getMonth() === birthDate.getMonth() && today.getDate() < birthDate.getDate()));

          if (age < 18) {
            alert('You must be 18 or older to use this service.');
            return false;
          }
        }
      }

      return true;
    }

    function updateProgress() {
      const progress = (currentStep / totalSteps) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
      document.getElementById('stepTitle').textContent = stepTitles[currentStep];
      document.getElementById('stepCounter').textContent = `Step ${currentStep} of ${totalSteps}`;
    }

    function updateButtons() {
      const backBtn = document.getElementById('backBtn');
      const nextBtn = document.getElementById('nextBtn');
      const submitBtn = document.getElementById('submitBtn');

      if (currentStep === 1) {
        backBtn.style.display = 'none';
      } else {
        backBtn.style.display = 'block';
      }

      if (currentStep === totalSteps) {
        nextBtn.style.display = 'none';
        submitBtn.style.display = 'block';
      } else {
        nextBtn.style.display = 'block';
        submitBtn.style.display = 'none';
      }
    }

    function memberLogin() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      if (!email || !password) {
        alert('Please enter both email and password.');
        return;
      }

      const formData = new FormData();
      formData.append('email', email);
      formData.append('password', password);

      fetch('/login', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          window.location.href = `/dashboard?email=${encodeURIComponent(email)}`;
        } else {
          alert(data.message || 'Login failed');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Login failed. Please try again.');
      });
    }

    // Close modals when clicking outside
    window.onclick = function(event) {
      const quizModal = document.getElementById('quizModal');
      const loginModal = document.getElementById('loginModal');

      if (event.target == quizModal) {
        closeQuiz();
      }
      if (event.target == loginModal) {
        closeLogin();
      }
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
      if (document.getElementById('quizModal').style.display === 'block') {
        if (e.key === 'Enter' && currentStep < totalSteps) {
          e.preventDefault();
          nextStep();
        }
      }
    });

    // Initialize range displays
    document.addEventListener('DOMContentLoaded', function() {
      updateRangeDisplay('motivationLevel', 5);
      updateRangeDisplay('stressLevel', 5);
    });
  </script>
</body>
</html>
